# äº‹ä»¶

äº‹ä»¶æ˜¯ç”¨æˆ·ä¸ç½‘é¡µå‘ç”Ÿçš„äº¤äº’åŠ¨ä½œæˆ–æµè§ˆå™¨çš„çŠ¶æ€å˜åŒ–ã€‚äº‹ä»¶è¢«å°è£…æˆä¸€ä¸ª event å¯¹è±¡ï¼ŒåŒ…å«äº†è¯¥äº‹ä»¶å‘ç”Ÿæ—¶çš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼ˆ event çš„å±æ€§ï¼‰ä»¥åŠå¯ä»¥å¯¹äº‹ä»¶è¿›è¡Œçš„æ“ä½œï¼ˆ event çš„æ–¹æ³•ï¼‰

## äº‹ä»¶å¤„ç†æœºåˆ¶

äº‹ä»¶å¤„ç†æœºåˆ¶å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯äº‹ä»¶æ•è·ï¼Œä¸€ç§æ˜¯äº‹ä»¶å†’æ³¡ï¼ˆåœ¨æ—©æœŸçš„IEå¹¶ä¸æ”¯æŒäº‹ä»¶æ•è·ï¼‰

### äº‹ä»¶æµ

äº‹ä»¶æµè§„å®šçˆ¶å­èŠ‚ç‚¹ç»‘å®šäº‹ä»¶æ—¶å€™ï¼Œå½“è§¦å‘å­èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå­˜åœ¨æ—¶é—´è§¦å‘é¡ºåºã€‚

äº‹ä»¶æµéƒ½ä¼šç»å†ä¸‰ä¸ªé˜¶æ®µï¼šäº‹ä»¶æ•è·é˜¶æ®µ(capture phase)ã€å¤„äºç›®æ ‡é˜¶æ®µ(target phase)ã€äº‹ä»¶å†’æ³¡é˜¶æ®µ(bubbling phase)

äº‹ä»¶å†’æ³¡æ˜¯ä¸€ç§ä»ä¸‹å¾€ä¸Šçš„ä¼ æ’­æ–¹å¼ï¼Œç”±æœ€å…·ä½“çš„å…ƒç´ ï¼ˆè§¦å‘èŠ‚ç‚¹ï¼‰ç„¶åé€æ¸å‘ä¸Šä¼ æ’­åˆ°æœ€ä¸å…·ä½“çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯DOMä¸­æœ€é«˜å±‚çš„çˆ¶èŠ‚ç‚¹

äº‹ä»¶æ•è·ä¸äº‹ä»¶å†’æ³¡ç›¸åï¼Œäº‹ä»¶æœ€å¼€å§‹ç”±ä¸å¤ªå…·ä½“çš„èŠ‚ç‚¹æœ€æ—©æ¥å—äº‹ä»¶, è€Œæœ€å…·ä½“çš„èŠ‚ç‚¹ï¼ˆè§¦å‘èŠ‚ç‚¹ï¼‰æœ€åæ¥å—äº‹ä»¶

## äº‹ä»¶æ¨¡å‹

> æ¥è‡ªå‰ç«¯è¯­éŸ³æ‰“å¡ç¤¾åŒº

äº‹ä»¶æ¨¡å‹å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼šåŸå§‹äº‹ä»¶æ¨¡å‹ï¼ˆDOM0çº§ï¼‰ã€æ ‡å‡†äº‹ä»¶æ¨¡å‹ï¼ˆDOM2çº§ï¼‰ã€IEäº‹ä»¶æ¨¡å‹ï¼ˆåŸºæœ¬ä¸ç”¨ï¼‰

### åŸå§‹äº‹ä»¶æ¨¡å‹

äº‹ä»¶ç»‘å®šç›‘å¬å‡½æ•°æ¯”è¾ƒç®€å•, æœ‰ä¸¤ç§æ–¹å¼ï¼š

HTMLä»£ç ä¸­ç›´æ¥ç»‘å®š

```html
<input type="button" onclick="fun()">
```

é€šè¿‡JSä»£ç ç»‘å®š

```js
var btn = document.getElementById('.btn');
btn.onclick = fun;
```

DOM0çº§æ–¹æ³•æŒ‡å®šçš„äº‹ä»¶å¤„ç†ç¨‹åºè¢«è®¤ä¸ºæ˜¯å…ƒç´ çš„æ–¹æ³•

ç‰¹æ€§:

- ç»‘å®šé€Ÿåº¦å¿«

  DOM0çº§äº‹ä»¶å…·æœ‰å¾ˆå¥½çš„è·¨æµè§ˆå™¨ä¼˜åŠ¿ï¼Œä¼šä»¥æœ€å¿«çš„é€Ÿåº¦ç»‘å®šï¼Œä½†ç”±äºç»‘å®šé€Ÿåº¦å¤ªå¿«ï¼Œå¯èƒ½é¡µé¢è¿˜æœªå®Œå…¨åŠ è½½å‡ºæ¥ï¼Œä»¥è‡³äºäº‹ä»¶å¯èƒ½æ— æ³•æ­£å¸¸è¿è¡Œ
- åªæ”¯æŒå†’æ³¡ï¼Œä¸æ”¯æŒæ•è·
- åŒä¸€ä¸ªç±»å‹çš„äº‹ä»¶åªèƒ½ç»‘å®šä¸€æ¬¡

  ```html
  <input type="button" id="btn" onclick="fun1()">
  ```

  ```js
  var btn = document.getElementById('.btn');
  btn.onclick = fun2;
  ```

  å¦‚ä¸Šï¼Œå½“å¸Œæœ›ä¸ºåŒä¸€ä¸ªå…ƒç´ ç»‘å®šå¤šä¸ªåŒç±»å‹äº‹ä»¶çš„æ—¶å€™ï¼ˆä¸Šé¢çš„è¿™ä¸ªbtnå…ƒç´ ç»‘å®š2ä¸ªç‚¹å‡»äº‹ä»¶ï¼‰ï¼Œæ˜¯ä¸è¢«å…è®¸çš„ï¼Œåç»‘å®šçš„äº‹ä»¶ä¼šè¦†ç›–ä¹‹å‰çš„äº‹ä»¶

- åˆ é™¤ DOM0 çº§äº‹ä»¶å¤„ç†ç¨‹åºåªè¦å°†å¯¹åº”äº‹ä»¶å±æ€§ç½®ä¸ºnullå³å¯

  ```js
  btn.onclick = null;
  ```

### æ ‡å‡†äº‹ä»¶æ¨¡å‹

åœ¨è¯¥äº‹ä»¶æ¨¡å‹ä¸­ï¼Œä¸€æ¬¡äº‹ä»¶å…±æœ‰ä¸‰ä¸ªè¿‡ç¨‹:

- äº‹ä»¶æ•è·é˜¶æ®µï¼šäº‹ä»¶ä»documentä¸€ç›´å‘ä¸‹ä¼ æ’­åˆ°ç›®æ ‡å…ƒç´ , ä¾æ¬¡æ£€æŸ¥ç»è¿‡çš„èŠ‚ç‚¹æ˜¯å¦ç»‘å®šäº†äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œ
- äº‹ä»¶å¤„ç†é˜¶æ®µï¼šäº‹ä»¶åˆ°è¾¾ç›®æ ‡å…ƒç´ , è§¦å‘ç›®æ ‡å…ƒç´ çš„ç›‘å¬å‡½æ•°
- äº‹ä»¶å†’æ³¡é˜¶æ®µï¼šäº‹ä»¶ä»ç›®æ ‡å…ƒç´ å†’æ³¡åˆ°document, ä¾æ¬¡æ£€æŸ¥ç»è¿‡çš„èŠ‚ç‚¹æ˜¯å¦ç»‘å®šäº†äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œ

äº‹ä»¶ç»‘å®šç›‘å¬å‡½æ•°çš„æ–¹å¼å¦‚ä¸‹:

```js
addEventListener(eventType, handler, useCapture)
```

äº‹ä»¶ç§»é™¤ç›‘å¬å‡½æ•°çš„æ–¹å¼å¦‚ä¸‹:

```js
removeEventListener(eventType, handler, useCapture)
```

å‚æ•°å¦‚ä¸‹ï¼š

- eventTypeæŒ‡å®šäº‹ä»¶ç±»å‹(ä¸è¦åŠ on)
- handleræ˜¯äº‹ä»¶å¤„ç†å‡½æ•°
- useCaptureæ˜¯ä¸€ä¸ªbooleanç”¨äºæŒ‡å®šæ˜¯å¦åœ¨æ•è·é˜¶æ®µè¿›è¡Œå¤„ç†ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºfalseä¸IEæµè§ˆå™¨ä¿æŒä¸€è‡´

ç‰¹æ€§:

- å¯ä»¥åœ¨ä¸€ä¸ªDOMå…ƒç´ ä¸Šç»‘å®šå¤šä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œå„è‡ªå¹¶ä¸ä¼šå†²çª

  ```js
  btn.addEventListener('click', showMessage1, false);
  btn.addEventListener('click', showMessage2, false);
  btn.addEventListener('click', showMessage3, false);
  ```
- é€šè¿‡addEventListeneræ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºæ­£èƒ½ç”¨removeEventListeneræ¥ç§»é™¤ï¼Œç§»é™¤æ—¶ä¼ å…¥çš„å‚æ•°è¦ä¸æ·»åŠ æ—¶ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´åŒ¿åå‡½æ•°æ— æ³•è¢«ç§»é™¤ã€‚
- å½“ç¬¬ä¸‰ä¸ªå‚æ•°(useCapture)è®¾ç½®ä¸ºtrueå°±åœ¨æ•è·è¿‡ç¨‹ä¸­æ‰§è¡Œï¼Œåä¹‹åœ¨å†’æ³¡è¿‡ç¨‹ä¸­æ‰§è¡Œå¤„ç†å‡½æ•°

### IEäº‹ä»¶æ¨¡å‹

IEäº‹ä»¶æ¨¡å‹å…±æœ‰ä¸¤ä¸ªè¿‡ç¨‹:

- äº‹ä»¶å¤„ç†é˜¶æ®µï¼šäº‹ä»¶åˆ°è¾¾ç›®æ ‡å…ƒç´ , è§¦å‘ç›®æ ‡å…ƒç´ çš„ç›‘å¬å‡½æ•°ã€‚
- äº‹ä»¶å†’æ³¡é˜¶æ®µï¼šäº‹ä»¶ä»ç›®æ ‡å…ƒç´ å†’æ³¡åˆ°document, ä¾æ¬¡æ£€æŸ¥ç»è¿‡çš„èŠ‚ç‚¹æ˜¯å¦ç»‘å®šäº†äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œ

äº‹ä»¶ç»‘å®šç›‘å¬å‡½æ•°çš„æ–¹å¼å¦‚ä¸‹:

```js
attachEvent(eventType, handler)
```

äº‹ä»¶ç§»é™¤ç›‘å¬å‡½æ•°çš„æ–¹å¼å¦‚ä¸‹:

```js
detachEvent(eventType, handler)
```
## äº‹ä»¶å¯¹è±¡
åœ¨è§¦å‘DOMäº‹ä»¶ä¹‹åä¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶å¯¹è±¡eventï¼Œè¿™ä¸ªå¯¹è±¡ä¸­åŒ…å«ç€ä¸äº‹ä»¶æœ‰å…³çš„ä¿¡æ¯

### é˜»æ­¢å†’æ³¡

event.stopPropagation() æˆ–è€… ie ä¸‹çš„æ–¹æ³• event.cancelBubble = true;

## äº‹ä»¶ç±»å‹

### UIäº‹ä»¶
- DOMActivateï¼šå·²å¼ƒç”¨
- loadï¼šé¡µé¢å®Œå…¨åŠ è½½ååœ¨windowä¸Šè§¦å‘
- unloadï¼šå½“é¡µé¢å®Œå…¨å¸è½½ååœ¨windowä¸Šè§¦å‘
- abortï¼šå½“ç”¨æˆ·åœæ­¢ä¸‹è½½æ—¶ï¼Œåœ¨`<Object>`å…ƒç´ ä¸Šè§¦å‘
- errorï¼šå‘ç”Ÿjsé”™è¯¯æ—¶åœ¨windowä¸Šè§¦å‘
- selectï¼šç”¨æˆ·é€‰æ‹©æ–‡æœ¬æ¡†æ—¶è§¦å‘
- resizeï¼šçª—å£å¤§å°å˜åŒ–æ—¶åœ¨windowä¸Šè§¦å‘
- scrollï¼šå¸¦æ»šåŠ¨æ¡çš„å…ƒç´ æ»šåŠ¨æ—¶è§¦å‘

### ç„¦ç‚¹äº‹ä»¶
- blurï¼šå¤±å»ç„¦ç‚¹æ—¶è§¦å‘ï¼Œä¸å†’æ³¡
- focusï¼šè·å¾—ç„¦ç‚¹æ—¶è§¦å‘ï¼Œä¸å†’æ³¡
- focusinï¼šè·å–ç„¦ç‚¹æ—¶è§¦å‘ï¼Œå†’æ³¡
- focusoutï¼šå¤±å»ç„¦ç‚¹æ—¶è§¦å‘ï¼Œå†’æ³¡

### é¼ æ ‡äº‹ä»¶
- clickï¼šç‚¹å‡»é¼ æ ‡ä¸»æŒ‰é”®æˆ–æŒ‰enter
- dbclickï¼šåŒå‡»é¼ æ ‡ä¸»é”®
- mousedownï¼šæŒ‰ä¸‹ä»»æ„é¼ æ ‡æŒ‰é”®
- mouseupï¼šé‡Šæ”¾é¼ æ ‡æŒ‰é”®è§¦å‘
- mouseenterï¼šé¼ æ ‡è¿›å…¥æŸä¸ªèŒƒå›´ä¹‹å†…ï¼Œä¸å†’æ³¡
- mouseleaveï¼šé¼ æ ‡ç¦»å¼€èŒƒå›´å†…ï¼Œä¸å†’æ³¡
- mousemoveï¼šé¼ æ ‡åœ¨å…ƒç´ å†…ç§»åŠ¨æ—¶è§¦å‘
- mouseoutï¼šé¼ æ ‡ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå…ƒç´ è§¦å‘ï¼ˆå¯èƒ½åœ¨åŸæœ¬çš„å…ƒç´ å†…ï¼‰
- mouseoverï¼šä»ä¸€ä¸ªå…ƒç´ å¤–éƒ¨ç§»å…¥å…ƒç´ å†…çš„å¦ä¸€ä¸ªå…ƒç´ æ—¶è§¦å‘

é¼ æ ‡äº‹ä»¶çš„å±æ€§ï¼š
- MouseEvent.altKey åªè¯» å½“é¼ æ ‡äº‹ä»¶è§¦å‘çš„æ—¶ï¼Œå¦‚æœ alt é”®è¢«æŒ‰ä¸‹ï¼Œè¿”å› true; 
- MouseEvent.button åªè¯» å½“é¼ æ ‡äº‹ä»¶è§¦å‘çš„æ—¶ï¼Œå¦‚æœé¼ æ ‡æŒ‰é’®è¢«æŒ‰ä¸‹ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªæ•°å€¼ã€‚
  - 0ï¼šä¸»æŒ‰é”®ï¼Œé€šå¸¸æŒ‡é¼ æ ‡å·¦é”®æˆ–é»˜è®¤å€¼ï¼ˆè¯‘è€…æ³¨ï¼šå¦‚ document.getElementById('a').click() è¿™æ ·è§¦å‘å°±ä¼šæ˜¯é»˜è®¤å€¼ï¼‰ 
  - 1ï¼šè¾…åŠ©æŒ‰é”®ï¼Œé€šå¸¸æŒ‡é¼ æ ‡æ»šè½®ä¸­é”® 
  - 2ï¼šæ¬¡æŒ‰é”®ï¼Œé€šå¸¸æŒ‡é¼ æ ‡å³é”® 
  - 3ï¼šç¬¬å››ä¸ªæŒ‰é’®ï¼Œé€šå¸¸æŒ‡æµè§ˆå™¨åé€€æŒ‰é’® 
  - 4ï¼šç¬¬äº”ä¸ªæŒ‰é’®ï¼Œé€šå¸¸æŒ‡æµè§ˆå™¨çš„å‰è¿›æŒ‰é’®
- MouseEvent.buttonsåªè¯» å½“é¼ æ ‡äº‹ä»¶è§¦å‘çš„æ—¶ï¼Œå¦‚æœå¤šä¸ªé¼ æ ‡æŒ‰é’®è¢«æŒ‰ä¸‹ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªæˆ–è€…å¤šä¸ªä»£è¡¨é¼ æ ‡æŒ‰é’®çš„æ•°å­—ã€‚
  - ä¸€ä¸ªæ•°å­—ï¼Œç”¨æ¥æ ‡è¯†é¼ æ ‡æŒ‰ä¸‹çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªæŒ‰é”®ã€‚å¦‚æœæŒ‰ä¸‹çš„é”®ä¸ºå¤šä¸ªï¼Œåˆ™å€¼ç­‰äºæ‰€æœ‰æŒ‰é”®å¯¹åº”æ•°å€¼è¿›è¡Œæˆ– (|) è¿ç®—çš„ç»“æœã€‚ 
  - 0: æ²¡æœ‰æŒ‰é”®æˆ–è€…æ˜¯æ²¡æœ‰åˆå§‹åŒ– 
  - 1: é¼ æ ‡å·¦é”® 
  - 2: é¼ æ ‡å³é”® 
  - 4: é¼ æ ‡æ»šè½®æˆ–è€…æ˜¯ä¸­é”® 
  - 8: ç¬¬å››æŒ‰é”® (é€šå¸¸æ˜¯â€œæµè§ˆå™¨åé€€â€æŒ‰é”®)
  - 16 : ç¬¬äº”æŒ‰é”® (é€šå¸¸æ˜¯â€œæµè§ˆå™¨å‰è¿›â€)
- MouseEvent.clientX åªè¯» é¼ æ ‡æŒ‡é’ˆåœ¨ç‚¹å‡»å…ƒç´ ï¼ˆDOMï¼‰ä¸­çš„ X åæ ‡ã€‚ 
- MouseEvent.clientY åªè¯» é¼ æ ‡æŒ‡é’ˆåœ¨ç‚¹å‡»å…ƒç´ ï¼ˆDOMï¼‰ä¸­çš„ Y åæ ‡ã€‚ 
- MouseEvent.ctrlKey åªè¯» å½“é¼ æ ‡äº‹ä»¶è§¦å‘æ—¶ï¼Œå¦‚æœ control é”®è¢«æŒ‰ä¸‹ï¼Œåˆ™è¿”å› trueï¼› 
- MouseEvent.metaKey åªè¯» å½“é¼ æ ‡äº‹ä»¶è§¦å‘æ—¶ï¼Œå¦‚æœ meta é”®è¢«æŒ‰ä¸‹ï¼Œåˆ™è¿”å› trueï¼› 
- MouseEvent.movementX åªè¯» é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äºæœ€åmousemoveäº‹ä»¶ä½ç½®çš„ X åæ ‡ã€‚ 
- MouseEvent.movementY åªè¯» é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äºæœ€åmousemoveäº‹ä»¶ä½ç½®çš„ Y åæ ‡ã€‚ 
- MouseEvent.region åªè¯» è¿”å›è¢«ç‚¹å‡»äº‹ä»¶å½±å“çš„ç‚¹å‡»åŒºåŸŸçš„ idï¼Œå¦‚æœæ²¡æœ‰åŒºåŸŸè¢«å½±å“åˆ™è¿”å› nullã€‚ 
- MouseEvent.screenX åªè¯» é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äºå…¨å±€ï¼ˆå±å¹•ï¼‰çš„ X åæ ‡ï¼› 
- MouseEvent.screenY åªè¯» é¼ æ ‡æŒ‡é’ˆç›¸å¯¹äºå…¨å±€ï¼ˆå±å¹•ï¼‰çš„ Y åæ ‡ï¼› 
- MouseEvent.shiftKey åªè¯» å½“é¼ æ ‡äº‹ä»¶è§¦å‘æ—¶ï¼Œå¦‚æœ shift é”®è¢«æŒ‰ä¸‹ï¼Œåˆ™è¿”å› trueï¼›

### é”®ç›˜äº‹ä»¶
- keydownï¼šæŒ‰ä¸‹ä»»æ„é”®è§¦å‘ï¼ŒæŒ‰ä½ä¸æ”¾ä¼šé‡å¤è§¦å‘
- keypressï¼šï¼ˆå·²å¼ƒç”¨ï¼‰æŒ‰ä¸‹ä»»æ„å­—ç¬¦æ—¶è§¦å‘ï¼ŒæŒ‰ä½ä¸æ”¾ä¼šé‡å¤è§¦å‘
- keyupï¼šé‡Šæ”¾é”®ç›˜ä¸Šçš„é”®æ—¶è§¦å‘

é”®ç å¯¹åº”ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/API/KeyboardEvent/code#code_values

### HTML5äº‹ä»¶
- contextmenuï¼šå³é”®è°ƒå‡ºèœå•æ—¶è§¦å‘
- beforeunloadï¼šåœ¨é¡µé¢å¸è½½ä¹‹å‰è°ƒç”¨ï¼Œç”¨æ¥é˜»æ­¢ç”¨æˆ·ç¦»å¼€
- DOMContentLoadedï¼šåœ¨å½¢æˆå®Œæ•´DOMæ ‘ä¹‹åè§¦å‘
- pageshowï¼šé¡µé¢æ˜¾ç¤ºæ—¶è§¦å‘
- pagehideï¼šä¸pageshowç›¸å
- hashchangeï¼šåœ¨URLçš„hashå€¼æ”¹å˜ä¹‹åè§¦å‘

## äº‹ä»¶ä»£ç†

äº‹ä»¶ä»£ç†å°±æ˜¯å°†ä¸€ä¸ªæˆ–è€…ä¸€ç»„å…ƒç´ çš„äº‹ä»¶å§”æ‰˜åˆ°å®ƒçš„çˆ¶å±‚æˆ–è€…æ›´å¤–å±‚å…ƒç´ ä¸Šï¼Œ
å¹¶é€šè¿‡äº‹ä»¶å†’æ³¡æœºåˆ¶å°†äº‹ä»¶äº¤ç»™å¤–å±‚å…ƒç´ ç»‘å®šçš„æ–¹æ³•å¤„ç†

é€‚åˆäº‹ä»¶å§”æ‰˜çš„äº‹ä»¶æœ‰ï¼š`clickï¼Œmousedownï¼Œmouseupï¼Œkeydownï¼Œkeyupï¼Œkeypress`

äº‹ä»¶å§”æ‰˜å­˜åœ¨ä¸¤å¤§ä¼˜ç‚¹ï¼š

- å‡å°‘æ•´ä¸ªé¡µé¢æ‰€éœ€çš„å†…å­˜ï¼Œæå‡æ•´ä½“æ€§èƒ½
- åŠ¨æ€ç»‘å®šï¼Œå‡å°‘é‡å¤å·¥ä½œ

å±€é™æ€§ï¼š

- focusã€blur è¿™äº›äº‹ä»¶æ²¡æœ‰äº‹ä»¶å†’æ³¡æœºåˆ¶ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œå§”æ‰˜ç»‘å®šäº‹ä»¶
- mousemoveã€mouseout è¿™æ ·çš„äº‹ä»¶ï¼Œè™½ç„¶æœ‰äº‹ä»¶å†’æ³¡ï¼Œä½†æ˜¯åªèƒ½ä¸æ–­é€šè¿‡ä½ç½®å»è®¡ç®—å®šä½ï¼Œå¯¹æ€§èƒ½æ¶ˆè€—é«˜ï¼Œå› æ­¤ä¹Ÿæ˜¯ä¸é€‚åˆäºäº‹ä»¶å§”æ‰˜çš„

## æ¨¡æ‹Ÿäº‹ä»¶
å¯ä»¥ç”¨jsèµ–åœ¨ä»»æ„æ—¶åˆ»è§¦å‘ä»»æ„äº‹ä»¶

å¯ä»¥é€šè¿‡å¯¹åº”äº‹ä»¶çš„**æ„é€ å‡½æ•°**åˆ›å»ºä¸€ä¸ªeventå¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³è¦åˆ›å»ºçš„æ—¶é—´ç±»å‹å‚æ•°ã€‚
ç„¶åç”¨å…ƒç´ çš„`dispatchEvent()`æ–¹æ³•è§¦å‘äº‹ä»¶

å¦‚æœæ˜¯è‡ªå®šä¹‰æ–¹æ³•å¯ä»¥é€šè¿‡`CustomEvent()`æ–¹æ³•æ„é€ ä¸€ä¸ªeventå¯¹è±¡ï¼Œç„¶åä½¿ç”¨å…ƒç´ çš„`addEventListener()`æ–¹æ³•æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºï¼Œ
ç„¶åç”¨å…ƒç´ çš„`dispatchEvent()`æ–¹æ³•è§¦å‘äº‹ä»¶ã€‚

ä¸¾ä¸ªğŸŒ°ï¼š
```js
const test = document.getElementById('test');
test.addEventListener('test',()=>{
    console.log('test');
})
const customEvent = new CustomEvent('test');
test.dispatchEvent(customEvent);
```

## å®ç°ä¸€ä¸ªé€šç”¨çš„äº‹ä»¶ç›‘å¬å™¨

```js
const EventUtils = {
    // è§†èƒ½åŠ›åˆ†åˆ«ä½¿ç”¨dom0||dom2||IEæ–¹å¼ æ¥ç»‘å®šäº‹ä»¶
    // æ·»åŠ äº‹ä»¶
    addEvent: function (element, type, handler) {
        if (element.addEventListener) {
            element.addEventListener(type, handler, false);
        } else if (element.attachEvent) {
            element.attachEvent("on" + type, handler);
        } else {
            element["on" + type] = handler;
        }
    },

    // ç§»é™¤äº‹ä»¶
    removeEvent: function (element, type, handler) {
        if (element.removeEventListener) {
            element.removeEventListener(type, handler, false);
        } else if (element.detachEvent) {
            element.detachEvent("on" + type, handler);
        } else {
            element["on" + type] = null;
        }
    },

    // è·å–äº‹ä»¶ç›®æ ‡
    getTarget: function (event) {
        return event.target || event.srcElement;
    },

    // è·å– event å¯¹è±¡çš„å¼•ç”¨ï¼Œå–åˆ°äº‹ä»¶çš„æ‰€æœ‰ä¿¡æ¯ï¼Œç¡®ä¿éšæ—¶èƒ½ä½¿ç”¨ event
    getEvent: function (event) {
        return event || window.event;
    },

    // é˜»æ­¢äº‹ä»¶ï¼ˆä¸»è¦æ˜¯äº‹ä»¶å†’æ³¡ï¼Œå› ä¸º IE ä¸æ”¯æŒäº‹ä»¶æ•è·ï¼‰
    stopPropagation: function (event) {
        if (event.stopPropagation) {
            event.stopPropagation();
        } else {
            event.cancelBubble = true;
        }
    },

    // å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸º
    preventDefault: function (event) {
        if (event.preventDefault) {
            event.preventDefault();
        } else {
            event.returnValue = false;
        }
    }
};
```

## æ•°æ®åŒå‘ç»‘å®š

æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„MVVMæ¡†æ¶ä¸­å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†å°±æ˜¯æ•°æ®çš„åŒå‘ç»‘å®šã€‚MVVMçš„æ•°æ®ç»‘å®šæ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬å…ˆè¯´ä¸€ä¸ªåŸç”ŸJSçš„
æ•°æ®åŒå‘ç»‘å®šæ–¹å¼

```html
<input id="input"/>
<button id="output"></button>
<script>
    let inputElement = document.getElementById("input");
    let outputElement = document.getElementById("output");
    let obj = {};
    // å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨domæ”¹å˜æ—¶ä¿®æ”¹objçš„å€¼
    // åŒæ—¶å¯¹è¿™ä¸ªå¯¹è±¡çš„æ•°æ®è¿›è¡ŒåŠ«æŒï¼Œè®©ä¿®æ”¹å¯¹è±¡å€¼æ—¶åŒæ—¶ä¿®æ”¹è¾“å…¥è¾“å‡ºå…ƒç´ çš„value
    Object.defineProperty(obj,"value",{
      // é‡å†™getæ–¹æ³•è¿”å›è¾“å…¥æ¡†çš„å€¼
      get(){
          return inputElement.value
      },
      // é‡å†™setæ–¹æ³•ï¼Œä¿®æ”¹æ—¶å°†è¾“å…¥æ¡†å’Œè¾“å‡ºæ¡†éƒ½ä¿®æ”¹
      set(v) {
          inputElement.value = v
          outputElement.innerText = v
      }
    })
    // åœ¨è¾“å…¥æ—¶åŒæ—¶ä¿®æ”¹objçš„å€¼
    inputElement.addEventListener("keyup",(ev)=>{
      console.log(ev)
      obj.value = ev.target.value;
    })
    // åœ¨è¾“å‡ºç‚¹å‡»åŠ ä¸€æ—¶ä¹ŸåŒæ­¥ä¿®æ”¹objçš„å€¼
    outputElement.addEventListener("click",()=>{
      obj.value = obj.value + "1";
    })
</script>
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ•°æ®åŠ«æŒå®ç°åŒå‘çš„æ•°æ®ç»‘å®šï¼Œä¸‹é¢æˆ‘ä»¬ä¼šä»¥vueä¸ºä¾‹è®²ä¸€ä¸‹MVVMæ¡†æ¶çš„æ•°æ®åŒå‘ç»‘å®šæ–¹å¼

åœ¨vueä¸­ï¼Œæ•°æ®çš„åŒå‘ç»‘å®šä»¥ æ•°æ®åŠ«æŒ + å‘å¸ƒè®¢é˜…æ¨¡å¼å®ç°

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<div id="name"></div>
<label>
  <input type="text">
</label>
</body>
<script>
  // vueæ•°æ®åŒå‘ç»‘å®šæ˜¯é€šè¿‡æ•°æ®åŠ«æŒç»“åˆå‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼çš„æ–¹å¼æ¥å®ç°çš„
  // åŠ«æŒæ•°æ®æ–¹æ³•ï¼š Object.defineProperty()
  // viewæ”¹å˜åæ›´æ–°modalå¾ˆç®€å•ï¼šäº‹ä»¶ç›‘å¬å°±å¯ä»¥ã€‚æ¯”å¦‚ç›‘å¬inputæ ‡ç­¾çš„inputäº‹ä»¶
  // é—®é¢˜çš„å…³é”®åœ¨äºmodalæ›´æ–°åå¦‚ä½•é€šçŸ¥viewï¼šç”¨Object.defineProperty()åŠ«æŒæ•°æ®

  const observer = (obj) => {
    if (typeof(obj) !== 'object') {
      return;
    }
    for (const key in obj) {
      let temp = obj[key];
      observer(temp); // é€’å½’éå†å­å±æ€§
      const dep = new Dep();
      Object.defineProperty(obj, key, {
        get: function() {
          // å°†è®¢é˜…å™¨Depæ·»åŠ è®¢é˜…è€…çš„æ“ä½œè®¾è®¡åœ¨getteré‡Œé¢ï¼Œè¿™æ˜¯ä¸ºäº†è®©Watcheråˆå§‹åŒ–æ—¶è¿›è¡Œè§¦å‘ï¼Œå› æ­¤éœ€è¦åˆ¤æ–­æ˜¯å¦è¦æ·»åŠ è®¢é˜…è€…ã€‚
          console.log('ç›‘å¬åˆ°äº†get:'+key);
          dep.depend();
          return temp;
        },
        set: function(value) {
          if(value === temp) {
            // æ•°æ®æ²¡æœ‰æ”¹å˜ï¼Œä¸éœ€è¦é€šçŸ¥
            return;
          }
          temp = value;
          dep.notify(); // æ•°æ®æ”¹å˜ï¼Œé€šçŸ¥è®¢é˜…è€…
          console.log('æ–°å€¼ä¸º:' + value);
        }
      });
    }
  }

  // ç”±äºè®¢é˜…è€…æœ‰å¾ˆå¤šï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ¶ˆæ¯è®¢é˜…å™¨ï¼Œç”¨æ¥æ”¶é›†è®¢é˜…è€…ï¼Œç„¶ååœ¨å±æ€§å˜åŒ–çš„æ—¶å€™æ‰§è¡Œå¯¹åº”è®¢é˜…è€…çš„æ›´æ–°å‡½æ•°ã€‚
  class Dep {
    constructor() {
      this.subscribes = [];
    }
    addSubscribe = (subscribe) => {
      this.subscribes.push(subscribe);
    }
    notify = () => {
      this.subscribes.forEach((subscribe) => {
        subscribe.update();
      })
    }
    //åˆ¤æ–­æ˜¯å¦å¢åŠ è®¢é˜…è€…
    depend = () => {
      if (Dep.target) {
        this.addSubscribe(Dep.target)
      }
    }
  }

  // è¿™æ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€ çš„Watcherï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å·§å¦™çš„è®¾è®¡ï¼Œå› ä¸ºåœ¨åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªå…¨å±€çš„ Watcher è¢«è®¡ç®—
  Dep.target = null;

  class Watcher {
    constructor(vm,exp,cb) {
      this.cb = cb; // Watcherç»‘å®šçš„æ›´æ–°å‡½æ•°
      this.vm = vm; // ä¸€ä¸ªVUEçš„å®ä¾‹å¯¹è±¡
      this.exp = exp; // nodeèŠ‚ç‚¹çš„v-modelæˆ–v-onï¼šclickç­‰æŒ‡ä»¤çš„å±æ€§å€¼ã€‚å¦‚v-model="name"ï¼Œexpå°±æ˜¯name
      this.value = this.get();  // å°†è‡ªå·±æ·»åŠ åˆ°è®¢é˜…å™¨çš„æ“ä½œ
    }
    update = () => {
      let value = this.vm.data[this.exp];
      let oldVal = this.value;
      if (value !== oldVal) {
        this.value = value;
        this.cb.call(this.vm, value, oldVal);
      }
    }
    get = () => {
      Dep.target = this;  // ç¼“å­˜è‡ªå·±
      // ä¸‹é¢è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šå¯¹ vm ä¸Šçš„æ•°æ®è®¿é—®ï¼Œå…¶å®å°±æ˜¯ä¸ºäº†è§¦å‘æ•°æ®å¯¹è±¡çš„getter
      let value = this.vm.data[this.exp]
      Dep.target = null;  // é‡Šæ”¾è‡ªå·±ï¼Œå½“å‰vmçš„æ•°æ®ä¾èµ–æ”¶é›†å·²ç»å®Œæˆï¼Œé‚£ä¹ˆå¯¹åº”çš„æ¸²æŸ“Dep.target ä¹Ÿéœ€è¦æ”¹å˜ã€‚
      return value;
    }
  }
  function MyVue (data, el, exp) {
    this.data = data;
    observer(data);                     //å°†æ•°æ®å˜çš„å¯è§‚æµ‹
    el.innerHTML = this.data[exp];           // åˆå§‹åŒ–æ¨¡æ¿æ•°æ®çš„å€¼
    new Watcher(this, exp, function (value) {
      el.innerHTML = value;
    });
    return this;
  }

  const ele = document.querySelector('#name');
  const input = document.querySelector('input');
  let myVue = new MyVue({
    name: 'hello world'
  }, ele, 'name');

  //æ”¹å˜è¾“å…¥æ¡†å†…å®¹
  input.oninput = function (e) {
    myVue.data.name = e.target.value
  }
</script>
</html>
```

åœ¨vue3ä¸­ï¼Œä½¿ç”¨proxyåšæ•°æ®çš„åŒå‘ç»‘å®šã€‚é‚£ä¹ˆå¦‚ä½•ç”¨proxyç›‘å¬Objectçš„å˜åŒ–å‘¢ï¼Ÿè¯·çœ‹ä¸‹é¢

```js
let obj = {
    a:'å…ƒç´ a',
    b:'å…ƒç´ b'
}
const handle = {
    get:(obj,prop)=>{
        console.log(`æ­£åœ¨è·å–ï¼š${prop}`);
        return obj[prop];
    },
    set:(obj,prop,value)=>{
        console.log(`æ­£åœ¨ä¿®æ”¹å…ƒç´ ï¼šå°†${prop}å±æ€§è®¾ç½®ä¸º${value}`);
        obj[prop] = value;
    }
}
const proxy = new Proxy(obj,handle);
console.log(proxy.a)
//æ­£åœ¨è·å–ï¼ša
// å…ƒç´ a
proxy.a='123'
// æ­£åœ¨ä¿®æ”¹å…ƒç´ ï¼šå°†aå±æ€§è®¾ç½®ä¸º123
console.log(proxy);
//Proxy {a: "123", b: "å…ƒç´ b"}
```