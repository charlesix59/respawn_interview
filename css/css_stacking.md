# CSS层叠顺序
默认情况下，网页内容是没有偏移角的垂直视觉呈现，当内容发生层叠的时候，一定会有一个前后的层叠顺序产生

## 层叠上下文
层叠上下文（stacking context）， 是HTML中的一个三维的概念。
如果一个元素含有层叠上下文，我们可以理解为这个元素在z轴上就“高人一等”。

特性：
- 层叠上下文的层叠水平要比普通元素高 
- 层叠上下文可以阻断元素的混合模式 
- 层叠上下文可以嵌套，内部层叠上下文及其所有子元素均受制于外部的层叠上下文。 
- 每个层叠上下文和兄弟元素独立，也就是当进行层叠变化或渲染的时候，只需要考虑后代元素。 
- 每个层叠上下文是自成体系的，当元素发生层叠的时候，整个元素被认为是在父层叠上下文的层叠顺序中。

### 层叠上下文的创建
创建层叠上下文的方式有三种：
- 根层级上下文：指的是页面根元素，也就是滚动条的默认的始作俑者<html>元素
- 传统层级上下文：对于包含有position:relative/position:absolute的定位元素，当其z-index值不是auto的时候，会创建层叠上下文
- CSS3层级上下文：其他CSS3新增属性引起的层级上下文
  - z-index值不为auto的flex项(父元素display:flex|inline-flex). 
  - 元素的opacity值不是1
  - 元素的transform值不是none
  - 元素mix-blend-mode（混合叠加模式） 值不是normal
  - 元素的filter值不是none
  - 元素的isolation值是isolate 
  - will-change指定属性值
  - 元素的-webkit-overflow-scrolling设为touch

## 层叠水平
层叠水平（stacking level）决定了同一个层叠上下文中元素在z轴上的显示顺序。
所有的元素都有层叠水平，包括层叠上下文元素。

普通元素的层叠水平优先由它所处的层叠上下文决定，因此，层叠水平的比较只有在当前层叠上下文元素中才有意义。

## 层叠顺序
层叠顺序（stacking order）表示元素发生层叠时候有着特定的垂直显示顺序。

![stacking-order.png](images/stacking-order.png)

层叠顺序的法则：
1. **谁大谁上**：当具有明显的层叠水平标示的时候，如z-indx数字值，在**同一个层叠上下文领域**，层叠水平值大的那一个覆盖小的那一个。 
2. **后来居上**：当元素的层叠水平一致、层叠顺序相同的时候，在DOM流中处于后面的元素会覆盖前面的元素。

